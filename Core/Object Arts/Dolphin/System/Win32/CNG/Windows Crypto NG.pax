| package |
package := Package name: 'Windows Crypto NG'.
package paxVersion: 2.1;
	basicComment: 'Dolphin Smalltalk Win32 Cryptograpy API: Next Generation

Nascent FFI wrappers for Windows Cryptography Next Generation (aka CNG) API. Limited to basic use of hash algorithms through functions currently.'.


package setClassNames: #(
	#{OS.BCRYPT_ALGORITHM_IDENTIFIER}
	#{OS.BCRYPT_PROVIDER_NAME}
	#{OS.BCryptLibrary}
).

package setVariableNames: #(
	#{OS.BCrypt}
).

package setBinaryVariableNames: #(
	#{OS.BCrypt}
).

package setPrerequisites: #(
	'..\..\..\Base\Dolphin'
).

package!

"Class Definitions"!

External.DynamicLinkLibrary
	subclass: #'OS.BCryptLibrary'
	instanceVariableNames: 'algorithmHandles'
	classVariableNames: ''
	imports: #()
	classInstanceVariableNames: ''
	classConstants: {
			'AlgorithmPseudoHandles'
				-> (LookupTable withAll: {
								'AES-CMAC' -> 16r101.
								'AES-GMAC' -> 16r111.
								'CAPI_KDF' -> 16r321.
								'CHACHA20_POLY1305' -> 16r3A1.
								'CSHAKE128' -> 16r411.
								'CSHAKE256' -> 16r421.
								'DH' -> 16r281.
								'DSA' -> 16r2D1.
								'ECDH' -> 16r291.
								'ECDH_P256' -> 16r2A1.
								'ECDH_P384' -> 16r2B1.
								'ECDH_P521' -> 16r2C1.
								'ECDSA' -> 16rF1.
								'ECDSA_P256' -> 16r2E1.
								'ECDSA_P384' -> 16r2F1.
								'ECDSA_P521' -> 16r301.
								'HKDF' -> 16r391.
								'KMAC128' -> 16r431.
								'KMAC256' -> 16r441.
								'MD2' -> 16r1.
								'MD4' -> 16r11.
								'MD5' -> 16r21.
								'PBKDF2' -> 16r331.
								'RC4' -> 16r71.
								'RNG' -> 16r81.
								'RSA' -> 16rE1.
								'RSA_SIGN' -> 16r311.
								'SHA1' -> 16r31.
								'SHA256' -> 16r41.
								'SHA3-256' -> 16r3B1.
								'SHA3-384' -> 16r3C1.
								'SHA3-512' -> 16r3D1.
								'SHA384' -> 16r51.
								'SHA512' -> 16r61.
								'SP800_108_CTR_HMAC' -> 16r341.
								'SP800_56A_CONCAT' -> 16r351.
								'TLS1_1_KDF' -> 16r361.
								'TLS1_2_KDF' -> 16r371.
								'XTS-AES' -> 16r381
							}).
			'BCRYPT_3DES_112_ALGORITHM' -> '3DES_112'.
			'BCRYPT_3DES_112_CBC_ALG_HANDLE' -> 16r171.
			'BCRYPT_3DES_112_CFB_ALG_HANDLE' -> 16r191.
			'BCRYPT_3DES_112_ECB_ALG_HANDLE' -> 16r181.
			'BCRYPT_3DES_ALGORITHM' -> '3DES'.
			'BCRYPT_3DES_CBC_ALG_HANDLE' -> 16r141.
			'BCRYPT_3DES_CFB_ALG_HANDLE' -> 16r161.
			'BCRYPT_3DES_ECB_ALG_HANDLE' -> 16r151.
			'BCRYPT_AES_ALGORITHM' -> 'AES'.
			'BCRYPT_AES_CBC_ALG_HANDLE' -> 16r1A1.
			'BCRYPT_AES_CCM_ALG_HANDLE' -> 16r1D1.
			'BCRYPT_AES_CFB_ALG_HANDLE' -> 16r1C1.
			'BCRYPT_AES_CMAC_ALG_HANDLE' -> 16r101.
			'BCRYPT_AES_CMAC_ALGORITHM' -> 'AES-CMAC'.
			'BCRYPT_AES_ECB_ALG_HANDLE' -> 16r1B1.
			'BCRYPT_AES_GCM_ALG_HANDLE' -> 16r1E1.
			'BCRYPT_AES_GMAC_ALG_HANDLE' -> 16r111.
			'BCRYPT_AES_GMAC_ALGORITHM' -> 'AES-GMAC'.
			'BCRYPT_AES_KWP_ALG_HANDLE' -> 16r451.
			'BCRYPT_ALG_HANDLE_HMAC_FLAG' -> 16r8.
			'BCRYPT_ALGORITHM_NAME' -> 'AlgorithmName'.
			'BCRYPT_ASYMMETRIC_ENCRYPTION_OPERATION' -> 16r4.
			'BCRYPT_AUTH_TAG_LENGTH' -> 'AuthTagLength'.
			'BCRYPT_BLOCK_LENGTH' -> 'BlockLength'.
			'BCRYPT_BLOCK_PADDING' -> 16r1.
			'BCRYPT_BLOCK_SIZE_LIST' -> 'BlockSizeList'.
			'BCRYPT_CAPI_AES_FLAG' -> 16r10.
			'BCRYPT_CAPI_KDF_ALG_HANDLE' -> 16r321.
			'BCRYPT_CAPI_KDF_ALGORITHM' -> 'CAPI_KDF'.
			'BCRYPT_CHACHA20_POLY1305_ALG_HANDLE' -> 16r3A1.
			'BCRYPT_CHACHA20_POLY1305_ALGORITHM' -> 'CHACHA20_POLY1305'.
			'BCRYPT_CHAIN_MODE_CBC' -> 'ChainingModeCBC'.
			'BCRYPT_CHAIN_MODE_CCM' -> 'ChainingModeCCM'.
			'BCRYPT_CHAIN_MODE_CFB' -> 'ChainingModeCFB'.
			'BCRYPT_CHAIN_MODE_ECB' -> 'ChainingModeECB'.
			'BCRYPT_CHAIN_MODE_GCM' -> 'ChainingModeGCM'.
			'BCRYPT_CHAIN_MODE_NA' -> 'ChainingModeN/A'.
			'BCRYPT_CHAINING_MODE' -> 'ChainingMode'.
			'BCRYPT_CIPHER_OPERATION' -> 16r1.
			'BCRYPT_CSHAKE128_ALG_HANDLE' -> 16r411.
			'BCRYPT_CSHAKE128_ALGORITHM' -> 'CSHAKE128'.
			'BCRYPT_CSHAKE256_ALG_HANDLE' -> 16r421.
			'BCRYPT_CSHAKE256_ALGORITHM' -> 'CSHAKE256'.
			'BCRYPT_DES_ALGORITHM' -> 'DES'.
			'BCRYPT_DES_CBC_ALG_HANDLE' -> 16r1F1.
			'BCRYPT_DES_CFB_ALG_HANDLE' -> 16r211.
			'BCRYPT_DES_ECB_ALG_HANDLE' -> 16r201.
			'BCRYPT_DESX_ALGORITHM' -> 'DESX'.
			'BCRYPT_DESX_CBC_ALG_HANDLE' -> 16r221.
			'BCRYPT_DESX_CFB_ALG_HANDLE' -> 16r241.
			'BCRYPT_DESX_ECB_ALG_HANDLE' -> 16r231.
			'BCRYPT_DH_ALG_HANDLE' -> 16r281.
			'BCRYPT_DH_ALGORITHM' -> 'DH'.
			'BCRYPT_DSA_ALG_HANDLE' -> 16r2D1.
			'BCRYPT_DSA_ALGORITHM' -> 'DSA'.
			'BCRYPT_ECDH_ALG_HANDLE' -> 16r291.
			'BCRYPT_ECDH_ALGORITHM' -> 'ECDH'.
			'BCRYPT_ECDH_P256_ALG_HANDLE' -> 16r2A1.
			'BCRYPT_ECDH_P256_ALGORITHM' -> 'ECDH_P256'.
			'BCRYPT_ECDH_P384_ALG_HANDLE' -> 16r2B1.
			'BCRYPT_ECDH_P384_ALGORITHM' -> 'ECDH_P384'.
			'BCRYPT_ECDH_P521_ALG_HANDLE' -> 16r2C1.
			'BCRYPT_ECDH_P521_ALGORITHM' -> 'ECDH_P521'.
			'BCRYPT_ECDSA_ALG_HANDLE' -> 16rF1.
			'BCRYPT_ECDSA_ALGORITHM' -> 'ECDSA'.
			'BCRYPT_ECDSA_P256_ALG_HANDLE' -> 16r2E1.
			'BCRYPT_ECDSA_P256_ALGORITHM' -> 'ECDSA_P256'.
			'BCRYPT_ECDSA_P384_ALG_HANDLE' -> 16r2F1.
			'BCRYPT_ECDSA_P384_ALGORITHM' -> 'ECDSA_P384'.
			'BCRYPT_ECDSA_P521_ALG_HANDLE' -> 16r301.
			'BCRYPT_ECDSA_P521_ALGORITHM' -> 'ECDSA_P521'.
			'BCRYPT_EFFECTIVE_KEY_LENGTH' -> 'EffectiveKeyLength'.
			'BCRYPT_GENERATE_IV' -> 16r20.
			'BCRYPT_HASH_BLOCK_LENGTH' -> 'HashBlockLength'.
			'BCRYPT_HASH_LENGTH' -> 'HashDigestLength'.
			'BCRYPT_HASH_OID_LIST' -> 'HashOIDList'.
			'BCRYPT_HASH_OPERATION' -> 16r2.
			'BCRYPT_HASH_REUSABLE_FLAG' -> 16r20.
			'BCRYPT_HKDF_ALG_HANDLE' -> 16r391.
			'BCRYPT_HKDF_ALGORITHM' -> 'HKDF'.
			'BCRYPT_HKDF_HASH_ALGORITHM' -> 'HkdfHashAlgorithm'.
			'BCRYPT_HKDF_PRK_AND_FINALIZE' -> 'HkdfPrkAndFinalize'.
			'BCRYPT_HKDF_SALT_AND_FINALIZE' -> 'HkdfSaltAndFinalize'.
			'BCRYPT_HMAC_MD2_ALG_HANDLE' -> 16r121.
			'BCRYPT_HMAC_MD4_ALG_HANDLE' -> 16r131.
			'BCRYPT_HMAC_MD5_ALG_HANDLE' -> 16r91.
			'BCRYPT_HMAC_SHA1_ALG_HANDLE' -> 16rA1.
			'BCRYPT_HMAC_SHA256_ALG_HANDLE' -> 16rB1.
			'BCRYPT_HMAC_SHA3_256_ALG_HANDLE' -> 16r3E1.
			'BCRYPT_HMAC_SHA3_384_ALG_HANDLE' -> 16r3F1.
			'BCRYPT_HMAC_SHA3_512_ALG_HANDLE' -> 16r401.
			'BCRYPT_HMAC_SHA384_ALG_HANDLE' -> 16rC1.
			'BCRYPT_HMAC_SHA512_ALG_HANDLE' -> 16rD1.
			'BCRYPT_INITIALIZATION_VECTOR' -> 'IV'.
			'BCRYPT_IS_IFX_TPM_WEAK_KEY' -> 'IsIfxTpmWeakKey'.
			'BCRYPT_IS_KEYED_HASH' -> 'IsKeyedHash'.
			'BCRYPT_IS_REUSABLE_HASH' -> 'IsReusableHash'.
			'BCRYPT_KEY_DERIVATION_OPERATION' -> 16r40.
			'BCRYPT_KEY_LENGTH' -> 'KeyLength'.
			'BCRYPT_KEY_LENGTHS' -> 'KeyLengths'.
			'BCRYPT_KEY_OBJECT_LENGTH' -> 'KeyObjectLength'.
			'BCRYPT_KEY_STRENGTH' -> 'KeyStrength'.
			'BCRYPT_KMAC128_ALG_HANDLE' -> 16r431.
			'BCRYPT_KMAC128_ALGORITHM' -> 'KMAC128'.
			'BCRYPT_KMAC256_ALG_HANDLE' -> 16r441.
			'BCRYPT_KMAC256_ALGORITHM' -> 'KMAC256'.
			'BCRYPT_MD2_ALG_HANDLE' -> 16r1.
			'BCRYPT_MD2_ALGORITHM' -> 'MD2'.
			'BCRYPT_MD4_ALG_HANDLE' -> 16r11.
			'BCRYPT_MD4_ALGORITHM' -> 'MD4'.
			'BCRYPT_MD5_ALG_HANDLE' -> 16r21.
			'BCRYPT_MD5_ALGORITHM' -> 'MD5'.
			'BCRYPT_MESSAGE_BLOCK_LENGTH' -> 'MessageBlockLength'.
			'BCRYPT_MULTI_FLAG' -> 16r40.
			'BCRYPT_MULTI_OBJECT_LENGTH' -> 'MultiObjectLength'.
			'BCRYPT_OBJECT_LENGTH' -> 'ObjectLength'.
			'BCRYPT_PAD_NONE' -> 16r1.
			'BCRYPT_PAD_OAEP' -> 16r4.
			'BCRYPT_PAD_PKCS1' -> 16r2.
			'BCRYPT_PAD_PKCS1_OPTIONAL_HASH_OID' -> 16r10.
			'BCRYPT_PAD_PSS' -> 16r8.
			'BCRYPT_PADDING_SCHEMES' -> 'PaddingSchemes'.
			'BCRYPT_PBKDF2_ALG_HANDLE' -> 16r331.
			'BCRYPT_PBKDF2_ALGORITHM' -> 'PBKDF2'.
			'BCRYPT_PCP_PLATFORM_TYPE_PROPERTY' -> 'PCP_PLATFORM_TYPE'.
			'BCRYPT_PCP_PROVIDER_VERSION_PROPERTY' -> 'PCP_PROVIDER_VERSION'.
			'BCRYPT_PRIMITIVE_TYPE' -> 'PrimitiveType'.
			'BCRYPT_PROV_DISPATCH' -> 16r1.
			'BCRYPT_PROVIDER_HANDLE' -> 'ProviderHandle'.
			'BCRYPT_PUBLIC_KEY_LENGTH' -> 'PublicKeyLength'.
			'BCRYPT_RC2_ALGORITHM' -> 'RC2'.
			'BCRYPT_RC2_CBC_ALG_HANDLE' -> 16r251.
			'BCRYPT_RC2_CFB_ALG_HANDLE' -> 16r271.
			'BCRYPT_RC2_ECB_ALG_HANDLE' -> 16r261.
			'BCRYPT_RC4_ALG_HANDLE' -> 16r71.
			'BCRYPT_RC4_ALGORITHM' -> 'RC4'.
			'BCRYPT_RNG_ALG_HANDLE' -> 16r81.
			'BCRYPT_RNG_ALGORITHM' -> 'RNG'.
			'BCRYPT_RNG_DUAL_EC_ALGORITHM' -> 'DUALECRNG'.
			'BCRYPT_RNG_FIPS186_DSA_ALGORITHM' -> 'FIPS186DSARNG'.
			'BCRYPT_RNG_OPERATION' -> 16r20.
			'BCRYPT_RSA_ALG_HANDLE' -> 16rE1.
			'BCRYPT_RSA_ALGORITHM' -> 'RSA'.
			'BCRYPT_RSA_SIGN_ALG_HANDLE' -> 16r311.
			'BCRYPT_RSA_SIGN_ALGORITHM' -> 'RSA_SIGN'.
			'BCRYPT_SECRET_AGREEMENT_OPERATION' -> 16r8.
			'BCRYPT_SHA1_ALG_HANDLE' -> 16r31.
			'BCRYPT_SHA1_ALGORITHM' -> 'SHA1'.
			'BCRYPT_SHA256_ALG_HANDLE' -> 16r41.
			'BCRYPT_SHA256_ALGORITHM' -> 'SHA256'.
			'BCRYPT_SHA3_256_ALG_HANDLE' -> 16r3B1.
			'BCRYPT_SHA3_256_ALGORITHM' -> 'SHA3-256'.
			'BCRYPT_SHA3_384_ALG_HANDLE' -> 16r3C1.
			'BCRYPT_SHA3_384_ALGORITHM' -> 'SHA3-384'.
			'BCRYPT_SHA3_512_ALG_HANDLE' -> 16r3D1.
			'BCRYPT_SHA3_512_ALGORITHM' -> 'SHA3-512'.
			'BCRYPT_SHA384_ALG_HANDLE' -> 16r51.
			'BCRYPT_SHA384_ALGORITHM' -> 'SHA384'.
			'BCRYPT_SHA512_ALG_HANDLE' -> 16r61.
			'BCRYPT_SHA512_ALGORITHM' -> 'SHA512'.
			'BCRYPT_SIGNATURE_LENGTH' -> 'SignatureLength'.
			'BCRYPT_SIGNATURE_OPERATION' -> 16r10.
			'BCRYPT_SP800108_CTR_HMAC_ALG_HANDLE' -> 16r341.
			'BCRYPT_SP800108_CTR_HMAC_ALGORITHM' -> 'SP800_108_CTR_HMAC'.
			'BCRYPT_SP80056A_CONCAT_ALG_HANDLE' -> 16r351.
			'BCRYPT_SP80056A_CONCAT_ALGORITHM' -> 'SP800_56A_CONCAT'.
			'BCRYPT_SUPPORTED_PAD_OAEP' -> 16r8.
			'BCRYPT_SUPPORTED_PAD_PKCS1_ENC' -> 16r2.
			'BCRYPT_SUPPORTED_PAD_PKCS1_SIG' -> 16r4.
			'BCRYPT_SUPPORTED_PAD_PSS' -> 16r10.
			'BCRYPT_SUPPORTED_PAD_ROUTER' -> 16r1.
			'BCRYPT_TLS1_1_KDF_ALG_HANDLE' -> 16r361.
			'BCRYPT_TLS1_1_KDF_ALGORITHM' -> 'TLS1_1_KDF'.
			'BCRYPT_TLS1_2_KDF_ALG_HANDLE' -> 16r371.
			'BCRYPT_TLS1_2_KDF_ALGORITHM' -> 'TLS1_2_KDF'.
			'BCRYPT_XTS_AES_ALG_HANDLE' -> 16r381.
			'BCRYPT_XTS_AES_ALGORITHM' -> 'XTS-AES'.
			'BCRYPTBUFFER_VERSION' -> 16r0.
			'MS_PLATFORM_CRYPTO_PROVIDER' -> 'Microsoft Platform Crypto Provider'.
			'MS_PRIMITIVE_PROVIDER' -> 'Microsoft Primitive Provider'
		}!

External.Structure
	subclass: #'OS.BCRYPT_ALGORITHM_IDENTIFIER'
	instanceVariableNames: ''
	classVariableNames: ''
	imports: #()
	classInstanceVariableNames: ''
	classConstants: {
			'_BCRYPT_ALGORITHM_IDENTIFIER_Size' -> 16rC.
			'_OffsetOf_dwClass' -> 16r4.
			'_OffsetOf_dwFlags' -> 16r8.
			'_OffsetOf_pszName' -> 16r0
		}!

External.Structure
	subclass: #'OS.BCRYPT_PROVIDER_NAME'
	instanceVariableNames: ''
	classVariableNames: ''
	imports: #()
	classInstanceVariableNames: ''
	classConstants: { '_BCRYPT_PROVIDER_NAME_Size' -> 16r4. '_OffsetOf_pszProviderName' -> 16r0 }!

"End of package definition"!

