| package |
package := Package name: 'ActiveX Automation Tests'.
package paxVersion: 2;
	preDeclareClassesOnLoad: false;
	basicComment: ''.


package setClassNames: #(
	#{BSTRTest}
	#{IDispatchTest}
	#{SAFEARRAYTest}
	#{VARIANTTest}
).

package setMethodNames: #(
	#(#{ExternalAddressTest} #testBSTRFromAddress)
	#(#{ExternalDescriptorTest} #testComPtrs)
).

package setPrerequisites: #(
	'ActiveX Automation'
	'..\..\..\Samples\ActiveX\Random\COM Random Stream'
	'..\..\Base\Dolphin'
	'..\..\Base\Dolphin Base Tests'
	'..\..\MVP\Base\Dolphin Basic Geometry'
	'..\COM\OLE COM'
).

package!

"Class Definitions"!

DolphinTest subclass: #BSTRTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''
	classConstants: {}!
DolphinTest subclass: #IDispatchTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''
	classConstants: {}!
DolphinTest subclass: #VARIANTTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'AXAutomationConstants'
	classInstanceVariableNames: ''
	classConstants: {}!
GenericExternalArrayTest subclass: #SAFEARRAYTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'Win32Errors'
	classInstanceVariableNames: ''
	classConstants: {}!

"Loose Methods"!

!ExternalAddressTest methodsFor!

testBSTRFromAddress
	| empty |
	self stringFromAddressTestClass: BSTR.
	"By convention, a null BSTR is equivalent to the empty string"
	empty := BSTR new.
	self assert: (BSTR fromAddress: nil) equals: empty.
	self assert: (BSTR fromAddress: 0) equals: empty! !
!ExternalAddressTest categoriesFor: #testBSTRFromAddress!public!unit tests! !

!ExternalDescriptorTest methodsFor!

testComPtrs
	self
		parseStructArg: IUnknown
		valueType: ExtCallArgSTRUCT
		refType: ExtCallArgCOMPTR.
	self
		parseStructArg: IDispatch
		valueType: ExtCallArgSTRUCT
		refType: ExtCallArgCOMPTR! !
!ExternalDescriptorTest categoriesFor: #testComPtrs!public!unit tests! !

"End of package definition"!

